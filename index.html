<!DOCTYPE html>
<html>
<head>
<title>Cross-Browser QRCode generator for Javascript</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
<script type="text/javascript" src="jquery.min.js"></script>
<script type="text/javascript" src="qrcode.js"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
            crossorigin="anonymous"></script>
</head>
<body>
<main class="container px-3 py-3 pt-md-5 pb-md-4 mx-auto">
    <div class="card">
        <h1 class="card-header text-center">QRCode Generator</h1>
        <div class="card-body">

            <ul class="nav nav-tabs" id="myTab" role="tablist">
                <li class="nav-item" role="presentation">
                    <a class="nav-link active" id="shortcuts-tab" data-bs-toggle="tab" href="#shortcuts" role="tab"
                       aria-controls="shortcuts" aria-selected="true">Shortcuts</a>
                </li>
                <li class="nav-item" role="presentation">
                    <a class="nav-link" id="custom-tab" data-bs-toggle="tab" href="#custom" role="tab"
                       aria-controls="custom" aria-selected="false">Custom</a>
                </li>
            </ul>
            <div class="tab-content" id="myTabContent" style="margin-top: 20px">
                <div class="tab-pane fade show active" id="shortcuts" role="tabpanel" aria-labelledby="shortcuts-tab">
                    <div class="row align-items-center">
                        <div class="col-9">

                            <div class="container">
                                <div class="row">
                                    <div class="col-12">
                                        <select class="form-select form-select-lg mb-3" aria-label=".form-select-lg example" id="server">
                                            <option value="http://vmdevqws.qualiac.fr/dvtora/rest" selected>vmdevqws</option>
                                            <option value="https://appstore.qualiac.com/qwsr/rest">appstore</option>
                                            <option value="http://srvpch.qualiac.fr:8182/H501PCHORA/rest">H501PCHORA</option>
                                            <option value="https://qualiacmobile-val.chuv.ch">CHUV-VAL</option>
                                            <option value="https://qualiacmobile.chuv.ch">CHUV-PROD</option>
                                        </select>
                                    </div>
                                    <div class="col-4">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="authenticated">
                                            <label class="form-check-label" for="authenticated">Authentification</label>
                                        </div>
                                    </div>
                                    <div class="col-8">
                                        <select class="form-select" id="authentication" disabled>
                                            <option value="TSTMOB:appstore12@2017">TSTMOB (appstore)</option>
                                            <option value="TSTNIV1A:appstore12@2017">TSTNIV1A (appstore)</option>
                                            <option value="TSTMOB:tstmob" selected>TSTMOB</option>
                                            <option value="GRI:grigri">GRI</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div class="col-3 text-center" id="qrcode-shortcuts"></div>
                    </div>
                </div>
                <div class="tab-pane fade" id="custom" role="tabpanel" aria-labelledby="custom-tab">
                    <div class="row align-items-center">
                        <div class="col-9">

                            <div class="container">
                                <div class="row">
                                    <div class="col-12">
                                        <input class="form-control form-control-lg" type="text" placeholder="https://"
                                               id="custom-url">
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div class="col-3 text-center" id="qrcode-custom"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
<br/>

<script type="text/javascript">
var qrcode = new QRCode(document.getElementById("qrcode-shortcuts"), {
	width : 200,
	height : 200
});
var qrcodeCustom = new QRCode(document.getElementById("qrcode-custom"), {
    width : 200,
    height : 200
});

function makeCode () {		
	var elText = document.getElementById("server");
	
	if (!elText.value) {
		elText.focus();
		return;
	}

	let url = new URL(elText.value)
    if ($("#authenticated").is(':checked')) {
        let authentication = $("#authentication").val().split(":")
        url.username = authentication[0]
        url.password = authentication[1]
    }
	qrcode.makeCode(url.toString());
}

function makeCustomCode () {
    var elText = document.getElementById("custom-url");

    if (!elText.value) {
        return;
    }

    qrcodeCustom.makeCode(elText.value)
}

makeCode();
makeCustomCode()

$("#server").on("change", function () {
    makeCode();
})
$("#authenticated").change(function () {
    $("#authentication").attr("disabled", !this.checked)
    makeCode()
})
$("#authentication").change(function () {
    makeCode()
})
$("#custom-url").change(function () {
    makeCustomCode()
})
</script>
</body>